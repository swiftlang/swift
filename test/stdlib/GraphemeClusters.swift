//
// Test that complex emojis are correctly segmented into Grapheme Clusters
// Checks for problems with flag emojis, family emojis using zero width joiners
// and skin tone modifiers in stdlb/public/core/StringCharacterView.swift.
//
// http://getemoji.com/
//

// RUN: %target-run-simple-swift
// REQUIRES: executable_test

import StdlibUnittest

var str="ğŸ‘¦ğŸ¾ğŸ‘§ğŸ¾ğŸ‘¨ğŸ¾ğŸ‘©ğŸ¾ğŸ‘´ğŸ¾ğŸ‘µğŸ¾ğŸ‘¶ğŸ¾ğŸ‘±ğŸ¾ğŸ‘®ğŸ¾ğŸ‘²ğŸ¾ğŸ‘³ğŸ¾ğŸ‘·ğŸ¾ğŸ‘¸ğŸ¾ğŸ’‚ğŸ¾ğŸ…ğŸ¾ğŸ‘¼ğŸ¾ğŸ’†ğŸ¾ğŸ’‡ğŸ¾ğŸ‘°ğŸ¾ğŸ™ğŸ¾ğŸ™ğŸ¾ğŸ™…ğŸ¾ğŸ™†ğŸ¾ğŸ’ğŸ¾ğŸ™‹ğŸ¾ğŸ™‡ğŸ¾ğŸ™ŒğŸ¾ğŸ™ğŸ¾ğŸš¶ğŸ¾ğŸƒğŸ¾ğŸ’ƒğŸ¾ğŸ’ªğŸ¾ğŸ‘ˆğŸ¾ğŸ‘‰ğŸ¾â˜ï¸ğŸ¾ğŸ‘†ğŸ¾ğŸ–•ğŸ¾ğŸ‘‡ğŸ¾âœŒï¸ğŸ¾ğŸ––ğŸ¾ğŸ¤˜ğŸ¾ğŸ–ğŸ¾âœŠğŸ¾âœ‹ğŸ¾ğŸ‘ŠğŸ¾ğŸ‘ŒğŸ¾ğŸ‘ğŸ¾ğŸ‘ğŸ¾ğŸ‘‹ğŸ¾ğŸ‘ğŸ¾ğŸ‘ğŸ¾âœğŸ¾ğŸ’…ğŸ¾ğŸ‘‚ğŸ¾ğŸ‘ƒğŸ¾ğŸš£ğŸ¾ğŸ›€ğŸ¾ğŸ„ğŸ¾ğŸ‡ğŸ¾ğŸŠğŸ¾â›¹ğŸ¾ğŸ‹ğŸ¾ğŸš´ğŸ¾ğŸšµğŸ¾ğŸ‘¨â€ğŸ‘¨â€ğŸ‘§â€ğŸ‘§ğŸ‘¨â€ğŸ‘¨â€ğŸ‘§â€ğŸ‘§ğŸ‘¨â€ğŸ‘¨â€ğŸ‘§â€ğŸ‘§kjhğŸ‡­ğŸ‡ºğŸ‡­ğŸ‡ºğŸ‡­ğŸ‡ºkgdfğŸ‘¨â€ğŸ‘¨â€ğŸ‘§â€ğŸ‘§ğŸ˜¦ğŸ˜§ğŸ˜¢ğŸ˜¥ğŸ˜ªğŸ˜“ğŸ˜­ğŸ˜µğŸ˜²ğŸ¤ğŸ˜·ğŸ¤’ğŸ¤•ğŸ˜´ğŸ’¤ğŸ’©ğŸ˜ˆğŸ‘¿ğŸ‘¹ğŸ‘ºğŸ’€ğŸ‘»ğŸ‘½ğŸ¤–ğŸ˜ºğŸ˜¸ğŸ˜¹ğŸ˜»ğŸ˜¼ğŸ˜½ğŸ™€ğŸ˜¿ğŸ˜¾ğŸ™ŒğŸ‘ğŸ‘‹ğŸ‘ğŸ‘ŠâœŠâœŒï¸ğŸ‘Œâœ‹ğŸ’ªğŸ™â˜ï¸ğŸ‘†ğŸ‘‡ğŸ‘ˆğŸ‘‰ğŸ–•ğŸ¤˜ğŸ––âœï¸ğŸ’…ğŸ‘„ğŸ‘…ğŸ‘‚ğŸ‘ƒğŸ‘ğŸ‘€ğŸ‘¤ğŸ—£ğŸ‘¶ğŸ‘¦ğŸ‘§ğŸ‘¨ğŸ‘©ğŸ‘±ğŸ‘´ğŸ‘µğŸ‘²ğŸ‘³ğŸ‘®ğŸ‘·ğŸ’‚ğŸ•µğŸ…ğŸ‘¼ğŸ‘¸ğŸ‘°ğŸš¶ğŸƒğŸ’ƒğŸ‘¯ğŸ‘«ğŸ‘¬ğŸ‘­ğŸ™‡ğŸ’ğŸ™…ğŸ™†ğŸ™‹ğŸ™ğŸ™ğŸ’‡ğŸ’†ğŸ’‘ğŸ‘©â€â¤ï¸â€ğŸ‘©ğŸ‘¨â€â¤ï¸â€ğŸ‘¨ğŸ’ğŸ‘©â€â¤ï¸â€ğŸ’‹â€ğŸ‘©ğŸ‘¨â€â¤ï¸â€ğŸ’‹â€ğŸ‘¨ğŸ‘ªğŸ‘¨â€ğŸ‘©â€ğŸ‘§ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ğŸ‘¨â€ğŸ‘©â€ğŸ‘¦â€ğŸ‘¦ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘§ğŸ‘©â€ğŸ‘©â€ğŸ‘¦ğŸ‘©â€ğŸ‘©â€ğŸ‘§ğŸ‘©â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ğŸ‘©â€ğŸ‘©â€ğŸ‘¦â€ğŸ‘¦ğŸ‘©â€ğŸ‘©â€ğŸ‘§â€ğŸ‘§ğŸ‘¨â€ğŸ‘¨â€ğŸ‘¦ğŸ‘¨â€ğŸ‘¨â€ğŸ‘§ğŸ‘¨â€ğŸ‘¨â€ğŸ‘§â€ğŸ‘¦ğŸ‘¨â€ğŸ‘¨â€ğŸ‘¦â€ğŸ‘¦ğŸ‘¨â€ğŸ‘¨â€ğŸ‘§â€ğŸ‘§ğŸ‘«ğŸ‘¬ğŸ‘­ğŸ‘šğŸ‘•ğŸ‘–ğŸ‘”ğŸ‘—ğŸ‘™ğŸ‘˜ğŸ’„ğŸ’‹ğŸ‘£ğŸ‘ ğŸ‘¡ğŸ‘¢ğŸ‘ğŸ‘ŸğŸ‘’ğŸ©â›‘ğŸ“ğŸ‘‘ğŸ’ğŸ‘ğŸ‘›ğŸ‘œğŸ’¼ğŸ‘“ğŸ•¶ğŸ’ğŸŒ‚ğŸ‡­ğŸ‡ºğŸ‡«ğŸ‡·ğŸ‡­ğŸ‡ºğŸ‡«ğŸ‡·ğŸ‡­ğŸ‡ºâ¤ï¸ğŸ’›ğŸ’™ğŸ’œğŸ’”â£ï¸ğŸ’•ğŸ’ğŸ’“ğŸ’—ğŸ’–ğŸ’˜ğŸ’ğŸ’Ÿâ˜®âœï¸â˜ªğŸ•‰â˜¸âœ¡ï¸ğŸ”¯ğŸ•â˜¯ï¸â˜¦ğŸ›â›â™ˆï¸â™‰ï¸â™Šï¸â™‹ï¸â™Œï¸â™ï¸â™ï¸â™ï¸â™ï¸â™‘ï¸â™’ï¸â™“ï¸ğŸ†”âš›ğŸˆ³ğŸˆ¹â˜¢â˜£ğŸ“´ğŸ“³ğŸˆ¶ğŸˆšï¸ğŸˆ¸ğŸˆºğŸˆ·ï¸âœ´ï¸ğŸ†šğŸ‰‘ğŸ’®ğŸ‰ãŠ™ï¸ãŠ—ï¸ğŸˆ´ğŸˆµğŸˆ²ğŸ…°ï¸ğŸ…±ï¸ğŸ†ğŸ†‘ğŸ…¾ï¸ğŸ†˜â›”ï¸ğŸ“›ğŸš«âŒâ­•ï¸ğŸ’¢â™¨ï¸ğŸš·ğŸš¯ğŸš³ğŸš±ğŸ”ğŸ“µâ—ï¸â•â“â”â€¼ï¸â‰ï¸ğŸ’¯ğŸ”…ğŸ”†ğŸ”±âšœã€½ï¸âš ï¸ğŸš¸ğŸ”°â™»ï¸ğŸˆ¯ï¸ğŸ’¹â‡ï¸âœ³ï¸ââœ…ğŸ’ ğŸŒ€â¿ğŸŒâ“‚ï¸ğŸ§ğŸˆ‚ï¸ğŸ›‚ğŸ›ƒğŸ›„ğŸ›…â™¿ï¸ğŸš­ğŸš¾ğŸ…¿ï¸ğŸš°ğŸš¹ğŸšºğŸš¼ğŸš»ğŸš®ğŸ¦ğŸ“¶ğŸˆğŸ†–ğŸ†—ğŸ†™ğŸ†’ğŸ†•ğŸ†“0ï¸âƒ£1ï¸âƒ£2ï¸âƒ£3ï¸âƒ£4ï¸âƒ£5ï¸âƒ£6ï¸âƒ£7ï¸âƒ£8ï¸âƒ£9ï¸âƒ£ğŸ”ŸğŸ”¢â–¶ï¸â¸â¯â¹âºâ­â®â©âªğŸ”€ğŸ”ğŸ”‚â—€ï¸ğŸ”¼ğŸ”½â«â¬â¡ï¸â¬…ï¸â¬†ï¸â¬‡ï¸â†—ï¸â†˜ï¸â†™ï¸â†–ï¸â†•ï¸â†”ï¸ğŸ”„â†ªï¸â†©ï¸â¤´ï¸â¤µï¸#ï¸âƒ£*ï¸âƒ£â„¹ï¸ğŸ”¤ğŸ”¡ğŸ” ğŸ”£ğŸµğŸ¶ã€°ï¸â°âœ”ï¸ğŸ”ƒâ•â–â—âœ–ï¸ğŸ’²ğŸ’±Â©ï¸Â®ï¸â„¢ï¸ğŸ”šğŸ”™ğŸ”›ğŸ”ğŸ”œâ˜‘ï¸ğŸ”˜âšªï¸âš«ï¸ğŸ”´ğŸ”µğŸ”¸ğŸ”¹ğŸ”¶ğŸ”·ğŸ”ºâ–ªï¸â–«ï¸â¬›ï¸â¬œï¸ğŸ”»â—¼ï¸â—»ï¸â—¾ï¸â—½ï¸ğŸ”²ğŸ”³ğŸ”ˆğŸ”‰ğŸ”ŠğŸ”‡ğŸ“£ğŸ“¢ğŸ””ğŸ”•ğŸƒğŸ€„ï¸â™ ï¸â™£ï¸â™¥ï¸â™¦ï¸ğŸ´ğŸ‘â€ğŸ—¨ğŸ’­ğŸ—¯ğŸ’¬ğŸ•ğŸ•‘ğŸ•’ğŸ•“ğŸ•”ğŸ••ğŸ•–ğŸ•—ğŸ•˜ğŸ•™ğŸ•šğŸ•›ğŸ•œğŸ•ğŸ•ğŸ•ŸğŸ• ğŸ•¡ğŸ•¢ğŸ•£ğŸ•¤ğŸ•¥ğŸ•¦ğŸ•§"

var EmojiTests = TestSuite("GraphemeClusters")

EmojiTests.test("segmentation") {
    var forward = Array<String>(), backward = Array<String>()

    var start = str.startIndex
    while start < str.endIndex{
        let next = str.index(start, offsetBy:1)
    //    print(str[start..<next])
        forward.append(str[start..<next])
        start = next
    }

    var end = str.endIndex
    while end > str.startIndex{
        let next = str.index(end, offsetBy:-1)
    //    print(str[next..<end])
        backward.append(str[next..<end])
        end = next
    }

    expectEqual(forward.count, 500)
    expectEqual(forward, backward.reversed())
}

runAllTests()
