import sys
import os
# TODO: Convert this in Python
tmp = sys.argv[1]
tests = sys.argv[2]

# RUN: echo "// AUTOGENERATED" > %t/all-tests.swift
with open(os.path.join(tmp, "all-tests.swift"), "w") as f:
    f.write("// AUTOGENERATED")

# RUN:
# for module in %S/Inputs/testcases/*.swift; do
#   modname=$(basename $module .swift);
#   echo "import $modname" >> %t/all-tests.swift;
# done
# TODO: .swift -> strip -> import
    for filename in os.listdir(tests):
        if not filename.endswith(".swift"):
           continue

        modname = os.path.splitext(filename)[0]
        print("modname:", modname)

# RUN: echo "func runAllTests() throws {" >> %t/all-tests.swift

# RUN:
# for module in %S/Inputs/testcases/*.swift; do
#   modname=$(basename $module .swift);

#   %target-build-swift -g -static -emit-module-path %t/$modname.swiftmodule -emit-module -emit-library -module-name $modname -o %t/%target-static-library-name($modname) -I%t -L%t $module -lRoundTrip;

#   echo "  print(\"--- $modname\")" >> %t/all-tests.swift;
#   echo "  $modname.test()" >> %t/all-tests.swift;
#   echo "  print(\"\")" >> %t/all-tests.swift;
#   echo "-l$modname" >> %t/link.txt;
# done

# RUN: echo "}" >> %t/all-tests.swift